{"version":3,"file":"js/889.dd879621.js","mappings":"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","sources":["webpack://vue3_nb0/../../../../../../../node_modules_admin/5/node_modules/core-js/internals/string-trim-forced.js","webpack://vue3_nb0/../../../../../../../node_modules_admin/5/node_modules/core-js/modules/es.array.map.js","webpack://vue3_nb0/../../../../../../../node_modules_admin/5/node_modules/core-js/modules/es.string.trim.js","webpack://vue3_nb0/./src/views/menu_manage/list.vue","webpack://vue3_nb0/./src/views/menu_manage/list.vue?b35b"],"sourcesContent":["var PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","<template>\r\n    <div>\r\n        <div class=\"center_view\" v-if=\"btnAuth('menu','菜单管理')\">\r\n            <div style=\"text-align: left;width: 100%;margin-bottom: 20px\">\r\n                <el-button type=\"primary\" style=\"width: 100px\" @click=\"save\">保存修改</el-button>\r\n            </div>\r\n            <el-tabs type=\"border-card\" v-model=\"role_index\" @tab-change=\"tabClick\">\r\n                <template v-for=\"(role,r_index) in menus\" :key=\"role.roleName\">\r\n                    <el-tab-pane :label=\"role.roleName\" :name=\"r_index\">\r\n                        <div v-if=\"r_index==role_index\">\r\n                            <el-collapse v-model=\"collapse_default\">\r\n                                <el-collapse-item v-for=\"(table,t_index) in role.backMenu\" :name=\"table.menu\">\r\n                                    <template #title>\r\n                                        <div style=\"width: 100%;display: flex;justify-content: space-between;align-items: center\">\r\n                                            <div style=\"font-weight: 700;font-size: 16px\">{{table.menu}}</div>\r\n                                            <div style=\"padding-right: 30px\">\r\n                                                <el-button size=\"small\" @click.stop=\"moveUp(role.backMenu,t_index)\">\r\n                                                    上移\r\n                                                </el-button>\r\n                                                <el-button size=\"small\" type=\"primary\" @click.stop=\"changeName(table,role.backMenu)\">\r\n                                                    修改菜单名\r\n                                                </el-button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </template>\r\n                                    <el-table\r\n                                        :data=\"table.child\"\r\n                                        :show-header=\"false\"\r\n                                        style=\"width: 100%;background: #edeef0;border: 1px solid #ddd\">\r\n                                        <el-table-column\r\n                                            prop=\"menu\"\r\n                                            label=\"菜单名\"\r\n                                            width=\"180\">\r\n                                        </el-table-column>\r\n                                        <el-table-column label=\"权限\">\r\n                                            <template #default=\"scope\">\r\n                                                <el-checkbox-group v-model=\"scope.row.buttons\">\r\n                                                    <el-checkbox v-for=\"item in scope.row.allButtons\" :label=\"item\" :value=\"item\" />\r\n                                                </el-checkbox-group>\r\n                                            </template>\r\n                                        </el-table-column>\r\n                                        <el-table-column label=\"操作\">\r\n                                            <template #default=\"scope\">\r\n                                                <el-button size=\"small\" @click=\"moveUp(table.child,scope.$index)\">\r\n                                                    上移\r\n                                                </el-button>\r\n                                                <el-button size=\"small\" type=\"primary\" @click=\"changeName(scope.row,table.child)\">\r\n                                                    修改菜单名\r\n                                                </el-button>\r\n                                                <el-button size=\"small\"\r\n                                                           type=\"warning\"\r\n                                                           @click=\"toMove(t_index,scope.$index)\">\r\n                                                    修改父级菜单\r\n                                                </el-button>\r\n                                            </template>\r\n                                        </el-table-column>\r\n                                    </el-table>\r\n                                </el-collapse-item>\r\n                            </el-collapse>\r\n                        </div>\r\n                    </el-tab-pane>\r\n                </template>\r\n            </el-tabs>\r\n        </div>\r\n        <el-dialog\r\n            title=\"修改父级菜单\"\r\n            v-model=\"dialogVisible\"\r\n            width=\"30%\">\r\n            <div style=\"display: flex;justify-content: center;align-items: center;margin-bottom: 20px\">\r\n                <div>父级菜单：</div>\r\n                <el-select v-model=\"n_first_index\" placeholder=\"请选择父级菜单\" style=\"width: 200px\">\r\n                    <el-option\r\n                        v-for=\"(item,index) in menus[role_index].backMenu\"\r\n                        :key=\"item.menu\"\r\n                        :label=\"item.menu\"\r\n                        :value=\"index\">\r\n                    </el-option>\r\n                </el-select>\r\n            </div>\r\n            <div style=\"width: 100%;text-align: center\">\r\n                <el-button type=\"primary\" @click=\"moveTo\">确 定</el-button>\r\n            </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport {getCurrentInstance,ref} from \"vue\";\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\nconst context = getCurrentInstance()?.appContext.config.globalProperties;\r\n\r\n//权限验证\r\nconst btnAuth = (e,a)=>{\r\n    return context?.$toolUtil.isAuth(e,a)\r\n}\r\n\r\nconst menus = ref([])\r\nconst role_index = ref(0)   //当前选中的角色index\r\nconst first_index = ref(0) //当前选中的一级菜单index\r\nconst collapse_default = ref([])    //展开的collapse\r\nconst getMenus = ()=>{\r\n    context.$http.get('menu/lists').then(res=>{\r\n        menus.value = JSON.parse(res.data.data[0].menujson)\r\n        collapse_default.value = menus.value[role_index.value].backMenu.map(item=>item.menu)\r\n    })\r\n}\r\ngetMenus()\r\n\r\nconst tabClick = ()=>{\r\n    collapse_default.value = menus.value[role_index.value].backMenu.map(item=>item.menu)\r\n}\r\n\r\nconst save = ()=>{\r\n    context.$http.post('menu/update',{\r\n        id:1,\r\n        menujson:JSON.stringify(menus.value)\r\n    }).then(res=>{\r\n        if(res.data.code==0){\r\n            ElMessage.success('保存成功，重新登录后生效')\r\n        }\r\n    })\r\n}\r\n\r\nconst dialogVisible = ref(false)\r\nconst n_first_index = ref(null)     //选中的父级菜单\r\nconst o_index = ref(0)      //需要移动的二级菜单的index\r\nconst toMove = (t_index,index)=>{\r\n    first_index.value = t_index\r\n    n_first_index.value = t_index\r\n    o_index.value = index\r\n    dialogVisible.value = true\r\n}\r\nconst moveTo = ()=>{\r\n    let items = menus.value[role_index.value].backMenu[first_index.value].child.splice(o_index.value,1)\r\n    menus.value[role_index.value].backMenu[n_first_index.value].child.push(...items)\r\n    dialogVisible.value = false\r\n}\r\nconst changeName = (row,arr)=>{\r\n    ElMessageBox.prompt('请输入新菜单名','修改菜单名',{\r\n        inputValidator:(value)=>{\r\n            if(!value || !value.trim())return '请输入菜单名'\r\n            if(arr.find(item=>item.menu==value.trim())){\r\n                return '该菜单名已存在'\r\n            }\r\n        },\r\n    }).then(({value})=>{\r\n        row.menu = value.trim()\r\n    }).catch(()=>{})\r\n}\r\nconst moveUp = (arr,index)=>{\r\n    if(index==0)return\r\n    arr.splice(index-1,0, ...arr.splice(index,1))\r\n    arr = JSON.parse(JSON.stringify(arr))\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>","import script from \"./list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./list.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["PROPER_FUNCTION_NAME","fails","whitespaces","non","module","exports","METHOD_NAME","name","$","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","target","proto","forced","map","callbackfn","this","arguments","length","undefined","$trim","forcedStringTrimMethod","trim","context","_getCurrentInstance","getCurrentInstance","appContext","config","globalProperties","btnAuth","e","a","$toolUtil","isAuth","menus","ref","role_index","first_index","collapse_default","getMenus","$http","get","then","res","value","JSON","parse","data","menujson","backMenu","item","menu","tabClick","save","post","id","stringify","code","ElMessage","dialogVisible","n_first_index","o_index","toMove","t_index","index","moveTo","_menus$value$role_ind","items","child","splice","push","apply","_toConsumableArray","changeName","row","arr","ElMessageBox","inputValidator","find","_ref","moveUp","_arr","concat","__exports__"],"sourceRoot":""}